function [dispOut, Fout, dFdq, dq, c33LIN]= nonlinearMooringLines
%UPDATED NOV 30, 2016 USING MAP++
c33LIN= 11940;

%First column is surge displacement
%Second column is surge force
data1= [-36,6705700;-35.9538000000000,6673000;-35.8491000000000,6672900;-35.7446000000000,6640100;-35.7447000000000,6607500;-35.7447000000000,6574800;-35.6402000000000,6542000;-35.5356000000000,6509300;-35.4311000000000,6476500;-35.3265000000000,6443700;-35.2219000000000,6411000;-35.1174000000000,6378200;-35.0128000000000,6345400;-35.0129000000000,6312800;-34.9083000000000,6312700;-34.8037000000000,6279900;-34.8037000000000,6247200;-34.6992000000000,6214500;-34.5947000000000,6181700;-34.5948000000000,6149000;-34.4901000000000,6148900;-34.4902000000000,6116300;-34.3857000000000,6083500;-34.2811000000000,6050700;-34.1764000000000,6050600;-34.1764000000000,6018000;-34.0720000000000,5985200;-33.9674000000000,5952400;-33.8629000000000,5919600;-33.7583000000000,5886900;-33.6537000000000,5854100;-33.5492000000000,5821300;-33.5493000000000,5788700;-33.4445000000000,5788600;-33.4447000000000,5755900;-33.3402000000000,5723100;-33.2356000000000,5690400;-33.2357000000000,5657700;-33.2358000000000,5625100;-33.2359000000000,5592400;-33.1312000000000,5592300;-33.0267000000000,5559500;-33.0267000000000,5526900;-32.9221000000000,5526700;-32.8175000000000,5494000;-32.8176000000000,5461300;-32.7130000000000,5428600;-32.6085000000000,5395800;-32.5040000000000,5363000;-32.3994000000000,5330200;-32.2948000000000,5297500;-32.1903000000000,5264700;-32.0856000000000,5264600;-32.0857000000000,5231900;-32.0858000000000,5199300;-32.0859000000000,5166600;-31.9813000000000,5166500;-31.8767000000000,5133700;-31.7721000000000,5101000;-31.6676000000000,5068200;-31.5630000000000,5035400;-31.4585000000000,5002700;-31.3538000000000,4969900;-31.3540000000000,4937200;-31.2494000000000,4904500;-31.1448000000000,4904300;-31.1449000000000,4871700;-31.1450000000000,4839000;-31.1450000000000,4806400;-31.0404000000000,4806300;-30.9358000000000,4773500;-30.9359000000000,4740800;-30.8313000000000,4740700;-30.7267000000000,4708000;-30.7268000000000,4675300;-30.7269000000000,4642700;-30.6223000000000,4642500;-30.5177000000000,4609800;-30.4131000000000,4577000;-30.3086000000000,4544200;-30.2040000000000,4511500;-30.0995000000000,4478700;-29.9948000000000,4478600;-29.9949000000000,4445900;-29.9950000000000,4413300;-29.9950000000000,4380600;-29.8904000000000,4347800;-29.7859000000000,4347700;-29.7860000000000,4315100;-29.6813000000000,4314900;-29.5768000000000,4282200;-29.4722000000000,4249400;-29.3676000000000,4216600;-29.2631000000000,4183900;-29.1585000000000,4151100;-29.0540000000000,4118300;-29.0541000000000,4085700;-28.9494000000000,4085600;-28.8449000000000,4052800;-28.8449000000000,4020100;-28.8450000000000,3987500;-28.7404000000000,3987400;-28.6358000000000,3954600;-28.6359000000000,3921900;-28.5312000000000,3921800;-28.4267000000000,3889100;-28.3222000000000,3856300;-28.2176000000000,3823500;-28.1130000000000,3790700;-28.0085000000000,3758000;-27.9039000000000,3725200;-27.7993000000000,3692400;-27.6947000000000,3692300;-27.5901000000000,3692200;-27.5901000000000,3659500;-27.5903000000000,3626900;-27.4857000000000,3594100;-27.3811000000000,3561300;-27.2766000000000,3528600;-27.1720000000000,3495800;-27.0675000000000,3463000;-27.0675000000000,3430400;-26.9630000000000,3397600;-26.8582000000000,3397500;-26.8584000000000,3364800;-26.7539000000000,3332100;-26.7540000000000,3299400;-26.6493000000000,3299300;-26.5448000000000,3266500;-26.5448000000000,3233900;-26.4402000000000,3233800;-26.3356000000000,3201000;-26.3357000000000,3168300;-26.3357000000000,3135700;-26.2312000000000,3135600;-26.1266000000000,3102800;-26.1267000000000,3070100;-26.0221000000000,3037400;-25.9175000000000,3037300;-25.8129000000000,3004500;-25.7084000000000,2971700;-25.6037000000000,2971600;-25.4992000000000,2938800;-25.3946000000000,2906100;-25.2901000000000,2873300;-25.1855000000000,2840500;-25.0809000000000,2807700;-25.0810000000000,2775100;-24.9764000000000,2775000;-24.9765000000000,2742300;-24.8719000000000,2709600;-24.7673000000000,2676800;-24.6627000000000,2644000;-24.5582000000000,2611200;-24.4536000000000,2611100;-24.4537000000000,2578500;-24.4538000000000,2545800;-24.3491000000000,2545700;-24.3492000000000,2513000;-24.2446000000000,2512900;-24.1399000000000,2512800;-24.1400000000000,2480200;-24.1401000000000,2447500;-24.0355000000000,2414700;-23.9308000000000,2414600;-23.8263000000000,2381800;-23.7217000000000,2381700;-23.6171000000000,2349000;-23.5126000000000,2316200;-23.4079000000000,2316100;-23.3034000000000,2283300;-23.1987000000000,2283200;-23.1988000000000,2250500;-23.0942000000000,2250400;-22.9895000000000,2250300;-22.9896000000000,2217600;-22.8851000000000,2184900;-22.7804000000000,2184800;-22.6758000000000,2184600;-22.5711000000000,2184500;-22.5712000000000,2151900;-22.4667000000000,2119100;-22.3620000000000,2119000;-22.2575000000000,2086200;-22.1529000000000,2053400;-22.0483000000000,2020700;-21.9437000000000,2020500;-21.8391000000000,2020400;-21.8391000000000,1987800;-21.7346000000000,1955000;-21.6299000000000,1954900;-21.6300000000000,1922200;-21.5255000000000,1889500;-21.4208000000000,1889300;-21.3162000000000,1889200;-21.2115000000000,1889100;-21.2116000000000,1856500;-21.1071000000000,1823700;-21.0024000000000,1823600;-20.8978000000000,1823500;-20.8979000000000,1790800;-20.7933000000000,1758000;-20.6886000000000,1757900;-20.5840000000000,1725100;-20.4795000000000,1725000;-20.3749000000000,1692300;-20.2703000000000,1692100;-20.2703000000000,1659500;-20.1657000000000,1659400;-20.0611000000000,1626600;-19.9566000000000,1593800;-19.8519000000000,1593700;-19.7473000000000,1560900;-19.6428000000000,1528200;-19.5382000000000,1528100;-19.5383000000000,1495400;-19.4337000000000,1462600;-19.3291000000000,1462500;-19.2244000000000,1462400;-19.1198000000000,1462300;-19.1199000000000,1429600;-19.0153000000000,1396900;-18.9106000000000,1396700;-18.8061000000000,1364000;-18.7016000000000,1331200;-18.5970000000000,1298400;-18.4924000000000,1298300;-18.3877000000000,1298200;-18.3878000000000,1265500;-18.2832000000000,1232800;-18.1786000000000,1232600;-18.0740000000000,1232500;-17.9693000000000,1232400;-17.9694000000000,1199800;-17.8648000000000,1167000;-17.7602000000000,1166900;-17.6555000000000,1166800;-17.5509000000000,1166600;-17.4463000000000,1166500;-17.3417000000000,1133800;-17.2371000000000,1101000;-17.1325000000000,1100900;-17.0279000000000,1100700;-16.9232000000000,1100600;-16.8186000000000,1100500;-16.7139000000000,1100400;-16.6093000000000,1100300;-16.6094000000000,1067600;-16.5048000000000,1034900;-16.4002000000000,1034700;-16.2955000000000,1034600;-16.1909000000000,1034500;-16.0862000000000,1034400;-15.9817000000000,1001600;-15.8770000000000,1001500;-15.7724000000000,1001400;-15.6678000000000,968610;-15.5632000000000,968490;-15.4586000000000,935720;-15.3540000000000,935600;-15.2494000000000,935480;-15.1447000000000,935370;-15.0401000000000,935250;-14.9355000000000,902480;-14.8309000000000,869710;-14.7263000000000,869590;-14.6217000000000,869470;-14.5170000000000,869360;-14.4123000000000,869240;-14.3077000000000,869120;-14.3078000000000,836470;-14.2033000000000,803700;-14.0986000000000,803580;-13.9940000000000,803460;-13.8893000000000,803350;-13.7847000000000,803230;-13.6800000000000,803110;-13.5754000000000,802990;-13.5755000000000,770340;-13.4708000000000,737570;-13.3663000000000,737450;-13.2616000000000,737330;-13.1570000000000,737220;-13.0524000000000,737100;-12.9477000000000,736980;-12.8431000000000,736860;-12.8432000000000,704210;-12.7386000000000,671440;-12.6340000000000,671320;-12.5293000000000,671210;-12.4247000000000,671090;-12.3200000000000,670970;-12.2155000000000,638200;-12.1108000000000,638080;-12.0063000000000,605310;-11.9016000000000,605200;-11.7970000000000,605080;-11.6923000000000,604960;-11.5877000000000,604840;-11.4830000000000,572070;-11.3785000000000,571960;-11.2738000000000,571840;-11.1692000000000,571720;-11.0646000000000,571600;-10.9599000000000,571490;-10.8553000000000,571370;-10.7506000000000,571250;-10.6461000000000,538480;-10.5415000000000,505710;-10.4369000000000,505590;-10.3322000000000,505470;-10.2276000000000,505360;-10.1229000000000,505240;-10.0183000000000,505120;-9.91370000000000,505010;-9.80900000000000,504890;-9.70440000000000,504770;-9.59970000000000,504650;-9.49500000000000,504540;-9.39050000000000,471760;-9.28600000000000,438990;-9.18130000000000,438880;-9.07670000000000,438760;-8.97200000000000,438640;-8.86740000000000,438520;-8.76280000000000,438410;-8.65810000000000,438290;-8.55350000000000,438170;-8.44870000000000,438050;-8.34420000000000,437940;-8.23950000000000,437820;-8.13490000000000,437700;-8.13500000000000,405050;-8.03040000000000,372280;-7.92580000000000,372160;-7.82110000000000,372040;-7.71650000000000,371930;-7.61180000000000,371810;-7.50720000000000,371690;-7.40260000000000,371570;-7.29790000000000,371460;-7.19330000000000,371340;-7.08860000000000,371220;-6.98400000000000,371100;-6.87930000000000,370990;-6.87940000000000,338330;-6.77490000000000,305560;-6.67020000000000,305450;-6.56550000000000,305330;-6.46090000000000,305210;-6.35630000000000,305090;-6.25170000000000,304980;-6.14700000000000,304860;-6.04240000000000,304740;-5.93770000000000,304620;-5.83320000000000,271850;-5.72850000000000,271740;-5.62390000000000,271620;-5.51920000000000,271500;-5.41460000000000,271380;-5.31000000000000,238610;-5.20540000000000,238500;-5.10070000000000,238380;-4.99620000000000,205610;-4.89150000000000,205490;-4.78690000000000,205370;-4.68230000000000,205260;-4.57760000000000,205140;-4.47290000000000,205020;-4.36830000000000,204900;-4.26370000000000,204790;-4.15900000000000,204670;-4.05440000000000,204550;-3.94980000000000,204430;-3.84510000000000,204320;-3.74050000000000,204200;-3.63580000000000,204080;-3.53120000000000,203960;-3.42660000000000,171190;-3.32200000000000,171080;-3.21740000000000,138310;-3.11280000000000,138190;-3.00810000000000,138070;-2.90350000000000,137950;-2.79890000000000,137840;-2.69420000000000,137720;-2.58960000000000,137600;-2.48490000000000,137480;-2.38030000000000,137370;-2.27560000000000,137250;-2.17100000000000,137130;-2.06640000000000,137010;-1.96180000000000,104240;-1.85720000000000,104130;-1.75250000000000,104010;-1.64790000000000,103890;-1.54320000000000,103770;-1.43860000000000,103660;-1.33380000000000,103540;-1.22930000000000,103420];
data2= [0.758800000000000,35883.0249000000;0.863300000000000,3112.60280000000;0.968000000000000,2995.14610000000;1.07250000000000,-29775.2759000000;1.17720000000000,-29892.7327000000;1.28180000000000,-30010.1894000000;1.38640000000000,-30127.6461000000;1.49100000000000,-30245.1028000000;1.59570000000000,-30362.5594000000;1.70040000000000,-30480.0162000000;1.80490000000000,-63250.4383000000;1.90960000000000,-63367.8950000000;2.01420000000000,-63485.3517000000;2.11890000000000,-63602.8084000000;2.22350000000000,-63720.2651000000;2.32820000000000,-63837.7218000000;2.43280000000000,-63955.1785000000;2.53730000000000,-64072.6352000000;2.64210000000000,-64190.0919000000;2.74670000000000,-64307.5486000000;2.85130000000000,-97077.9707000000;2.95590000000000,-97195.4274000000;3.06060000000000,-97312.8841000000;3.16520000000000,-97430.3408000000;3.26990000000000,-97547.7974000000;3.37450000000000,-97665.2542000000;3.47910000000000,-130440;3.58360000000000,-130550;3.68830000000000,-130670;3.79300000000000,-130790;3.89760000000000,-130910;4.00230000000000,-131020;4.10690000000000,-131140;4.21160000000000,-131260;4.31620000000000,-131380;4.42080000000000,-164150;4.52530000000000,-164260;4.63000000000000,-164380;4.73470000000000,-164500;4.83930000000000,-164620;4.94400000000000,-164730;5.04860000000000,-164850;5.15330000000000,-164970;5.25780000000000,-197740;5.36250000000000,-197860;5.46710000000000,-197970;5.57180000000000,-198090;5.67640000000000,-198210;5.78100000000000,-198330;5.88560000000000,-231100;5.99020000000000,-231210;6.09490000000000,-231330;6.19950000000000,-231450;6.30420000000000,-231570;6.40880000000000,-231680;6.51350000000000,-231800;6.61810000000000,-231920;6.72270000000000,-232040;6.82740000000000,-232150;6.93200000000000,-232270;7.03660000000000,-265040;7.14120000000000,-265160;7.24590000000000,-265280;7.35040000000000,-298050;7.45510000000000,-298160;7.55960000000000,-298280;7.66440000000000,-298400;7.76900000000000,-298520;7.87360000000000,-298630;7.97830000000000,-298750;8.08290000000000,-298870;8.18760000000000,-298990;8.29220000000000,-299100;8.39690000000000,-299220;8.50130000000000,-331990;8.60610000000000,-332110;8.71070000000000,-332230;8.81540000000000,-332340;8.92000000000000,-332460;9.02460000000000,-332580;9.12920000000000,-365350;9.23380000000000,-365470;9.33850000000000,-365580;9.44310000000000,-365700;9.54780000000000,-365820;9.65240000000000,-365940;9.75700000000000,-366050;9.86170000000000,-366170;9.96630000000000,-366290;10.0710000000000,-366410;10.1756000000000,-366520;10.2803000000000,-366640;10.3849000000000,-366760;10.4896000000000,-366880;10.5941000000000,-366990;10.6987000000000,-367110;10.8035000000000,-367230;10.8034000000000,-399880;10.9080000000000,-432650;11.0126000000000,-432770;11.1172000000000,-432890;11.2219000000000,-433000;11.3265000000000,-433120;11.4312000000000,-433240;11.5358000000000,-433360;11.6404000000000,-433470;11.7450000000000,-433590;11.8497000000000,-433710;11.9544000000000,-433830;12.0590000000000,-433940;12.1637000000000,-434060;12.2683000000000,-434180;12.3730000000000,-434300;12.4776000000000,-434410;12.5823000000000,-434530;12.6867000000000,-467300;12.7915000000000,-467420;12.8960000000000,-500190;13.0007000000000,-500310;13.1053000000000,-500420;13.2099000000000,-500540;13.3146000000000,-500660;13.4192000000000,-500780;13.5239000000000,-500890;13.6284000000000,-501010;13.7332000000000,-501130;13.8377000000000,-533900;13.9424000000000,-534020;14.0470000000000,-534130;14.1516000000000,-534250;14.2563000000000,-534370;14.3609000000000,-534490;14.4656000000000,-534600;14.5702000000000,-534720;14.6749000000000,-534840;14.7795000000000,-534960;14.8841000000000,-567730;14.9887000000000,-567840;15.0933000000000,-567960;15.1979000000000,-600730;15.3025000000000,-600850;15.4072000000000,-600970;15.5118000000000,-601080;15.6165000000000,-601200;15.7210000000000,-601320;15.8258000000000,-601440;15.9304000000000,-601550;16.0351000000000,-601670;16.1397000000000,-601790;16.2443000000000,-601910;16.3490000000000,-602020;16.4536000000000,-602140;16.5583000000000,-602260;16.5582000000000,-634910;16.6627000000000,-635030;16.7673000000000,-667800;16.8719000000000,-667920;16.9767000000000,-668040;17.0813000000000,-668150;17.1860000000000,-668270;17.2906000000000,-668390;17.3952000000000,-668500;17.4999000000000,-668620;17.6045000000000,-668740;17.7092000000000,-668860;17.8138000000000,-668970;17.9184000000000,-669090;18.0231000000000,-669210;18.1277000000000,-669330;18.2324000000000,-669440;18.3370000000000,-669560;18.4417000000000,-669680;18.5463000000000,-669800;18.5462000000000,-702450;18.6509000000000,-702570;18.7553000000000,-735340;18.8601000000000,-735460;18.9647000000000,-735570;19.0694000000000,-735690;19.1740000000000,-735810;19.2787000000000,-735930;19.3833000000000,-736040;19.4879000000000,-736160;19.5926000000000,-736280;19.6972000000000,-736390;19.8018000000000,-736510;19.9064000000000,-736630;20.0112000000000,-736750;20.1158000000000,-736860;20.2204000000000,-736980;20.3251000000000,-737100;20.4297000000000,-737220;20.4296000000000,-769870;20.5342000000000,-802640;20.6388000000000,-802760;20.7435000000000,-802880;20.8481000000000,-802990;20.9527000000000,-803110;21.0574000000000,-803230;21.1621000000000,-803350;21.2667000000000,-803460;21.3713000000000,-803580;21.4760000000000,-803700;21.5806000000000,-803810;21.6853000000000,-803930;21.7899000000000,-804050;21.8946000000000,-804170;21.9992000000000,-804280;22.1038000000000,-804400;22.2084000000000,-837170;22.3130000000000,-837290;22.4177000000000,-837410;22.5222000000000,-870180;22.6269000000000,-870300;22.7315000000000,-870410;22.8362000000000,-870530;22.9407000000000,-870650;23.0455000000000,-870770;23.1501000000000,-870880;23.2548000000000,-871000;23.3594000000000,-871120;23.4640000000000,-871240;23.5686000000000,-904010;23.6732000000000,-904120;23.7779000000000,-904240;23.8824000000000,-904360;23.9872000000000,-904480;24.0918000000000,-904590;24.1965000000000,-904710;24.3010000000000,-937480;24.4057000000000,-937600;24.5103000000000,-937720;24.6149000000000,-970490;24.7195000000000,-970600;24.8241000000000,-970720;24.9287000000000,-970840;25.0334000000000,-970960;25.1381000000000,-971070;25.2427000000000,-971190;25.3474000000000,-971310;25.4520000000000,-971430;25.5566000000000,-971540;25.5566000000000,-1004200;25.6611000000000,-1037000;25.7658000000000,-1037100;25.8704000000000,-1037200;25.9750000000000,-1037300;26.0796000000000,-1037400;26.1843000000000,-1037600;26.2890000000000,-1037700;26.3936000000000,-1037800;26.4983000000000,-1037900;26.6029000000000,-1038000;26.7076000000000,-1038100;26.8122000000000,-1038300;26.9167000000000,-1038400;26.9167000000000,-1071000;27.0213000000000,-1103800;27.1260000000000,-1103900;27.2306000000000,-1104000;27.3352000000000,-1104200;27.4399000000000,-1104300;27.5445000000000,-1104400;27.6492000000000,-1104500;27.7538000000000,-1104600;27.8585000000000,-1104700;27.9630000000000,-1104900;28.0677000000000,-1105000;28.1724000000000,-1105100;28.2770000000000,-1105200;28.3817000000000,-1105300;28.4863000000000,-1105400;28.4862000000000,-1138100;28.5908000000000,-1170900;28.6954000000000,-1171000;28.8001000000000,-1171100;28.9047000000000,-1171200;29.0094000000000,-1171300;29.1140000000000,-1171500;29.2186000000000,-1171600;29.3233000000000,-1171700;29.4279000000000,-1171800;29.5326000000000,-1171900;29.6372000000000,-1172000;29.7419000000000,-1172200;29.8465000000000,-1172300;29.8464000000000,-1204900;29.9510000000000,-1237700;30.0556000000000,-1237800;30.1602000000000,-1237900;30.2649000000000,-1238100;30.3695000000000,-1270800;30.4741000000000,-1270900;30.5788000000000,-1271100;30.6834000000000,-1271200;30.7880000000000,-1271300;30.8927000000000,-1271400;30.9971000000000,-1304200;31.1019000000000,-1304300;31.2065000000000,-1304400;31.3111000000000,-1337200;31.4157000000000,-1337300;31.5204000000000,-1337400;31.6250000000000,-1337500;31.7297000000000,-1337700;31.7296000000000,-1370300;31.8342000000000,-1370400;31.9388000000000,-1403200;32.0434000000000,-1403300;32.1481000000000,-1403400;32.2527000000000,-1403500;32.3573000000000,-1403700;32.4620000000000,-1403800;32.5666000000000,-1403900;32.6713000000000,-1404000;32.7759000000000,-1404100;32.8806000000000,-1404300;32.9851000000000,-1404400;33.0898000000000,-1437100;33.1944000000000,-1437300;33.2991000000000,-1437400;33.4036000000000,-1470100;33.5083000000000,-1470300;33.6129000000000,-1470400;33.7175000000000,-1470500;33.8222000000000,-1470600;33.8221000000000,-1503300;33.9266000000000,-1536000;34.0313000000000,-1536200;34.1359000000000,-1536300;34.2406000000000,-1536400;34.3452000000000,-1536500;34.4499000000000,-1536600;34.5545000000000,-1536700;34.6592000000000,-1536900;34.7638000000000,-1537000;34.7637000000000,-1569600;34.8683000000000,-1569800;34.9729000000000,-1602500;35.0776000000000,-1602600;35.1822000000000,-1602800;35.2868000000000,-1602900;35.3915000000000,-1603000;35.4960000000000,-1635800;35.6007000000000,-1635900;35.7053000000000,-1636000];

disp1= [data1(:,1)' data2(:,1)'];
Force= [data1(:,2)' data2(:,2)'];

disp2= [-36 -30 -24 -18 -12 -6 0 6 12 18 24 30 36];
Moment= [-4.6144e8 -3.0178e8 -1.6334e8 -7.878e7 -3.9937e7 -2.068e7 0 1.6196e7 2.8916e7 4.6535e7 6.0888e7 8.0145e7 1.1246e8];

L_Mooring_SWL= 70; %"depth to fairleads" [m]

Force_mom= -Moment./L_Mooring_SWL;

% ForceSmooth= smooth(Force, 100);
% DispSmooth= smooth(disp1, 100);
% dFdq_check= gradient(ForceSmooth, DispSmooth);

% DispSmooth= DispSmooth(1:10:end);
% ForceSmooth= ForceSmooth(1:10:end);
% dFdqSmooth= gradient(ForceSmooth, DispSmooth);

% % figure(1);
% % plot(disp1, Force, disp2, Force_mom)
% % 
% % figure(2);
% % plot(disp2, Moment);
% 
% 
% 
disp= disp2;
F= Force_mom;



%Make sure matches with Jonkman linearization for small displacements
F(6)= -41180*disp(6);
F(8)= -41180*disp(8);

% %November 30, 2016- MAP output
dispOut= [-40,-38,-36,-34,-32,-30,-28,-26,-24,-22,-20,-18,-16,-14,-12,-10,-8,-6,-4,-2,0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58];
Fout= [8300919.64856810,7512958.53583141,6729668.69428857,5953305.17777745,5187534.08557659,4438450.59372402,3716248.61653562,3037397.60162631,2425459.30203695,1905578.74191498,1490793.45204762,1173276.18859266,931974.729857525,745107.836973597,595879.732348512,472699.841879464,366022.746219553,266737.581691639,173388.680971703,85077.6921482970,999.442796320398,-79570.3656999854,-157286.474379982,-232744.335918413,-306489.352125016,-379025.138716867,-450820.899784809,-522318.004019264,-593935.855724593,-666077.148946954,-739904.244473719,-817911.367239168,-901457.412571922,-992110.462822785,-1091776.85097715,-1202783.91924604,-1327959.86173299,-1470688.07984019,-1634865.95976817,-1824699.98335294,-2044269.10580686,-2296830.86331940,-2584056.35151396,-2905547.54517236,-3258934.94570229,-3640518.39877679,-4046101.34427925,-4471662.84661912,-4913725.84329053,-5369467.62755709];
Fout(21)= 0;
dFdq= gradient(Fout, dispOut);
dq= dispOut(2) - dispOut(1);

%many values needed for probability and diff accuracy
% dispOut= linspace(-36, 36, 400);
% Fout= interp1(disp, F, dispOut);
% dFdq= gradient(Fout, dispOut);
% dFdq_s= smooth(dFdq, 25)';
% dq= dispOut(2) - dispOut(1);
end